!function e(t,n,r){function s(a,i){if(!n[a]){if(!t[a]){var o="function"==typeof require&&require;if(!i&&o)return o(a,!0);if(u)return u(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return s(n?n:e)},c,c.exports,e,t,n,r)}return n[a].exports}for(var u="function"==typeof require&&require,a=0;a<r.length;a++)s(r[a]);return s}({1:[function(e,t){function n(e,t){this.apiUri=e,this.client_id=t.client_id,this.client_secret=t.client_secret,this.teams={}}var r=e("./utils"),s=e("./status_code"),u=null,a=n.prototype;a.execute=function(e,t){var n=this,r=n.teams[e],s=new Date;return r&&s.getTime()<r.expires?t.call(n):n._auth(e,function(e){return e?t.call(n,e):t.call(n)})},a.getToken=function(e){return this.teams[e].token},a._auth=function(e,t){var n=this,u=null,a=new XMLHttpRequest;t&&"function"==typeof t&&(u=t),a.open("POST",n.apiUri+"/api/v1/oauth/client_token",!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),a.onload=function(){var t,r=JSON.parse(a.responseText),i=new Date;if(a.status===s.OK||a.status===s.NOT_MODIFIED){if(n.teams[e]={token:r.access_token,expires:i.setTime(i.getTime()+r.expires_in)},u)return u.call(null,null,r)}else if(t={status:a.status,message:r.message},u)return u.call(null,t);return r},a.onerror=function(){var e={status:s.SERVER_ERROR,message:a.statusText};return u?u.call(null,e):e},a.send(r.serializeObject({grant_type:"client_credentials",client_id:n.client_id,client_secret:n.client_secret,team_name:e}))},t.exports=function(e,t){if(u)return u;if(!e)throw new Error("API uri must be set");if(!t.client_id)throw new Error("options must include client_id");if(!t.client_secret)throw new Error("options must include client_secret");return u=new n(e,t)}},{"./status_code":5,"./utils":7}],2:[function(e,t){function n(e){this.apiUri=e,this.auth=r()}var r=e("./auth"),s=e("./status_code"),u=null,a=n.prototype;a.getAll=function(e,t){var n=this,r=null,u=function(t){var u=new XMLHttpRequest;return t?r?r.call(null,t):t:(u.open("GET",n.apiUri+"/api/v1/channels/all",!0),u.setRequestHeader("Content-Type","application/json"),u.setRequestHeader("Authorization","Bearer:"+n.auth.getToken(e)),u.onload=function(){var e,t,n=JSON.parse(u.responseText);if(u.status===s.OK||u.status===s.NOT_MODIFIED){if(t=n.channels.map(function(e){return{id:e.id,type:"O"===e.type?"channel":"group",display_name:e.display_name,name:e.name}}),r)return r.call(null,null,t)}else if(e={status:u.status,message:n.message},r)return r.call(null,e);return n},u.onerror=function(){var e={status:s.SERVER_ERROR,message:u.statusText};return r?r.call(null,e):e},u.send())};t&&"function"==typeof t&&(r=t),n.auth.execute(e,u)},a.getMembers=function(e,t,n,r){var u=this,a=null,i=function(r){var i=new XMLHttpRequest;if(r)return a?a.call(null,r):r;var o=u.apiUri+"/api/v1/channels/"+t+"/members";return n&&n>0&&(o=o+"/"+n.toString()),i.open("GET",o,!0),i.setRequestHeader("Content-Type","application/json"),i.setRequestHeader("Authorization","Bearer:"+u.auth.getToken(e)),i.onerror=function(){var e={status:s.SERVER_ERROR,message:i.statusText};return a?a.call(null,e):e},i.onload=function(){var e,t=JSON.parse(i.responseText);if(i.status===s.OK||i.status===s.NOT_MODIFIED){if(a)return a.call(null,null,t)}else if(e={status:i.status,message:t.message},a)return a.call(null,e);return t},i.send()};return r&&"function"==typeof r&&(a=r),u.auth.execute(e,i)},t.exports=function(e){if(u)return u;if(!e)throw new Error("API uri must be set");return u=new n(e)}},{"./auth":1,"./status_code":5}],3:[function(e){function t(e){var t=document.createElement("a");return t.href=e,t.origin}function n(){}var r=e("./auth"),s=e("./channels"),u=e("./messages"),a=e("./users"),i=n.prototype;i.initialize=function(e){if(!e)throw new Error("options need to be set");if(!e.client_id)throw new Error("options must include client_id");if(!e.client_secret)throw new Error("options must include client_secret");if(!e.icon_url)throw new Error("options must include icon_url");if(!e.username)throw new Error("options must include username");this.apiUri=t(e.url||"https://zboxnow.com/"),e.url=this.apiUri,r(this.apiUri,{client_id:e.client_id,client_secret:e.client_secret}),this.channels=s(this.apiUri),this.users=a(this.apiUri),this.messages=u(e)},window.zbox=function(){"use strict";return new n}()},{"./auth":1,"./channels":2,"./messages":4,"./users":6}],4:[function(e,t){function n(e){this.apiUri=e.url,this.iconUrl=e.icon_url,this.username=e.username,this.auth=r()}var r=e("./auth"),s=e("./status_code"),u=4e3,a=null,i=n.prototype;i.prepare=function(e){var t=this;return{text:e,username:t.username,icon_url:t.iconUrl}},i.send=function(e,t,n,r){var a,i,o=this,l=t||"town-square",c=new XMLHttpRequest;return r&&"function"==typeof r&&(i=r),n?n.length>u?void(i&&i.call(null,{status:s.BAD_REQUEST,message:"Message cannot be longer than "+u+" characters"})):(a={text:n,channel:l,username:o.username,icon_url:o.iconUrl},c.open("POST",o.apiUri+"/hooks/"+e,!0),c.setRequestHeader("Content-Type","application/json"),c.onerror=function(){var e={status:s.SERVER_ERROR,message:c.statusText};return i?i.call(null,e):e},c.onload=function(){var e,t=c.responseText;if(c.status===s.OK||c.status===s.NOT_MODIFIED){if(i)return i.call(null,null)}else if(e={status:c.status,message:t.message},i)return i.call(null,e);return t},void c.send(JSON.stringify(a))):void(i&&i.call(null,{status:s.BAD_REQUEST,message:"No text specified"}))},i.sendEphemeral=function(e,t,n,r,a){var i,o,l=this,c=t||"town-square",p=new XMLHttpRequest;return a&&"function"==typeof a&&(o=a),r?r.length>u?void(o&&o.call(null,{status:s.BAD_REQUEST,message:"Message cannot be longer than "+u+" characters"})):(i={text:r,channel:c,username:l.username,icon_url:l.iconUrl},p.open("POST",l.apiUri+"/ephemeral/"+e+"/"+n,!0),p.setRequestHeader("Content-Type","application/json"),p.onerror=function(){var e={status:s.SERVER_ERROR,message:p.statusText};return o?o.call(null,e):e},p.onload=function(){var e,t=p.responseText;if(p.status===s.OK||p.status===s.NOT_MODIFIED){if(o)return o.call(null,null)}else if(e={status:p.status,message:t.message},o)return o.call(null,e);return t},void p.send(JSON.stringify(i))):void(o&&o.call(null,{status:s.BAD_REQUEST,message:"No text specified"}))},t.exports=function(e){if(a)return a;if(!e)throw new Error("options need to be set");if(!e.url)throw new Error("options url must be set");if(!e.icon_url)throw new Error("options must include icon_url");if(!e.username)throw new Error("options must include username");return a=new n(e)}},{"./auth":1,"./status_code":5}],5:[function(e,t){var n={OK:200,NOT_MODIFIED:304,BAD_REQUEST:400,SERVER_ERROR:500};t.exports=n},{}],6:[function(e,t){function n(e){this.apiUri=e,this.auth=r()}var r=e("./auth"),s=e("./status_code"),u=null,a=n.prototype;a.getAll=function(e,t){var n=this,r=null,u=function(t){var u=new XMLHttpRequest;return t?r?r.call(null,t):t:(u.open("GET",n.apiUri+"/api/v1/users/profiles",!0),u.setRequestHeader("Content-Type","application/json"),u.setRequestHeader("Authorization","Bearer:"+n.auth.getToken(e)),u.setRequestHeader("Accept","application/json"),u.onerror=function(){var e={status:s.SERVER_ERROR,message:u.statusText};return r?r.call(null,e):e},u.onload=function(){var e,t,n=JSON.parse(u.responseText);if(u.status===s.OK||u.status===s.NOT_MODIFIED){if(t=Object.keys(n).map(function(e){var t=n[e];return{id:e,username:t.username,email:t.email,nickname:t.nickname,first_name:t.first_name,last_name:t.last_name,locale:t.locale,roles:t.roles}}).filter(function(e){var t=e.roles;return delete e.roles,"systembot"!==e.username&&"guest"!==t}),r)return r.call(null,null,t)}else if(e={status:u.status,message:n.message},r)return r.call(null,e);return n},u.send())};t&&"function"==typeof t&&(r=t),n.auth.execute(e,u)},a.getStatuses=function(e,t,n){var r=this,u=null,a=function(n){var a=new XMLHttpRequest;return n?u?u.call(null,n):n:(a.open("POST",r.apiUri+"/api/v1/users/status",!0),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("Authorization","Bearer:"+r.auth.getToken(e)),a.setRequestHeader("Accept","application/json"),a.onerror=function(){var e={status:s.SERVER_ERROR,message:a.statusText};return u?u.call(null,e):e},a.onload=function(){var e,t=JSON.parse(a.responseText);if(a.status===s.OK||a.status===s.NOT_MODIFIED){if(u)return u.call(null,null,t)}else if(e={status:a.status,message:t.message},u)return u.call(null,e);return t},a.send(JSON.stringify(t)))};if(n&&"function"==typeof n&&(u=n),!Array.isArray(t)){var i={status:s.BAD_REQUEST,message:"usersIds must be an array"};return u.call(null,i)}return r.auth.execute(e,a)},t.exports=function(e){if(u)return u;if(!e)throw new Error("API uri must be set");return u=new n(e)}},{"./auth":1,"./status_code":5}],7:[function(e,t){var n={};n.serializeObject=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n])+"&");return t.slice(0,-1)},t.exports=n},{}]},{},[1,2,3,4,5,6,7]);
//# sourceMappingURL=./dist/bundle.min.js.map